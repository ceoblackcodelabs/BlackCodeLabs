{% extends 'Home/base.html' %}
{% load static %}

{% block title %}Games | BlackCodeLabs{% endblock %}

{% block extra_css %}
<style>
    /* Games-specific styles */
    .games-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        gap: 30px;
        margin: 40px 0 60px;
    }
    
    .game-card {
        background: rgba(20, 20, 20, 0.8);
        border-radius: 15px;
        overflow: hidden;
        transition: transform 0.3s, box-shadow 0.3s;
        position: relative;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        cursor: pointer;
    }
    
    .game-card:hover {
        transform: translateY(-10px) scale(1.02);
        box-shadow: 0 20px 40px rgba(255, 255, 255, 0.15);
        border-color: rgba(0, 255, 136, 0.3);
    }
    
    .game-card.coming-soon {
        opacity: 0.8;
        cursor: not-allowed;
    }
    
    .game-card.coming-soon:hover {
        transform: none;
        box-shadow: none;
    }
    
    .game-image {
        height: 200px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    .game-image i {
        font-size: 80px;
        color: white;
    }
    
    .game-content {
        padding: 25px;
    }
    
    .game-meta {
        display: flex;
        justify-content: space-between;
        margin-bottom: 15px;
        color: var(--gray);
        font-size: 0.85rem;
    }
    
    .game-meta span {
        display: flex;
        align-items: center;
        gap: 5px;
    }
    
    .game-content h3 {
        font-size: 1.5rem;
        margin-bottom: 15px;
        color: var(--light);
        line-height: 1.4;
    }
    
    .game-content p {
        color: var(--gray);
        margin-bottom: 20px;
        line-height: 1.6;
        font-size: 0.95rem;
    }
    
    .play-button {
        display: inline-block;
        color: var(--accent);
        font-weight: 600;
        text-decoration: none;
        padding: 8px 0;
        position: relative;
        transition: transform 0.2s;
    }
    
    .play-button:after {
        content: 'â†’';
        margin-left: 5px;
        transition: transform 0.3s;
    }
    
    .play-button:hover:after {
        transform: translateX(5px);
    }
    
    .play-button:active {
        transform: scale(0.95);
    }
    
    .coming-soon-badge {
        display: inline-block;
        background: rgba(255, 255, 255, 0.1);
        color: var(--gray);
        padding: 5px 15px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 600;
        border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    /* Game Modal Styles */
    .game-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.95);
        z-index: 1000;
        overflow-y: auto;
        padding: 20px;
    }
    
    .game-modal.active {
        display: block;
    }
    
    .game-modal-content {
        background: var(--dark);
        max-width: 900px;
        margin: 50px auto;
        border-radius: 15px;
        overflow: hidden;
        position: relative;
        animation: modalSlideIn 0.3s ease;
        border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    @keyframes modalSlideIn {
        from {
            opacity: 0;
            transform: translateY(-50px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .game-modal-header {
        padding: 30px;
        background: rgba(20, 20, 20, 0.9);
        position: relative;
    }
    
    .game-modal-close {
        position: absolute;
        top: 20px;
        right: 20px;
        background: none;
        border: none;
        color: var(--light);
        font-size: 1.5rem;
        cursor: pointer;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        transition: background 0.3s;
    }
    
    .game-modal-close:hover {
        background: rgba(255, 255, 255, 0.1);
    }
    
    .game-modal-title {
        font-size: 2.5rem;
        margin-bottom: 15px;
        color: var(--light);
        line-height: 1.3;
    }
    
    .game-modal-meta {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        color: var(--gray);
        font-size: 0.95rem;
        align-items: center;
    }
    
    .game-modal-meta span {
        display: flex;
        align-items: center;
        gap: 5px;
    }
    
    .game-modal-body {
        padding: 30px;
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    
    .game-container {
        background: rgba(0, 0, 0, 0.5);
        border-radius: 10px;
        padding: 20px;
        margin: 20px 0;
        min-height: 500px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        border: 2px solid rgba(255, 255, 255, 0.1);
        width: 100%;
    }
    
    .game-frame {
        width: 100%;
        max-width: 900px;
        height: 800px;
        border: none;
        border-radius: 8px;
        background: #000;
    }
    
    .game-placeholder {
        width: 100%;
        padding: 40px 20px;
        text-align: center;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 20px;
    }
    
    .game-placeholder i {
        font-size: 80px;
        color: var(--accent);
        margin-bottom: 10px;
    }
    
    .game-placeholder h3 {
        font-size: 1.8rem;
        margin: 0;
        color: var(--light);
        line-height: 1.2;
    }

    .game-placeholder p {
        color: var(--gray);
        margin: 0;
        font-size: 1rem;
        max-width: 500px;
        line-height: 1.5;
    }

    .game-stats {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
        margin: 20px 0;
        padding: 20px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 10px;
        width: 100%;
        max-width: 500px;
    }

    .stat-item {
        text-align: center;
        display: flex;
        flex-direction: column;
        gap: 5px;
    }

    .stat-number {
        font-size: 2rem;
        font-weight: bold;
        color: var(--accent);
        line-height: 1;
    }

    .stat-label {
        color: var(--gray-light);
        font-size: 0.85rem;
        font-weight: 500;
    }
    
    .game-instructions {
        background: rgba(255, 255, 255, 0.05);
        padding: 30px;
        border-radius: 10px;
        margin: 40px 0;
        text-align: left;
    }
    
    .game-instructions h3 {
        font-size: 1.5rem;
        color: var(--light);
        margin-bottom: 20px;
        text-align: center;
    }
    
    .game-instructions ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }
    
    .game-instructions li {
        color: var(--gray);
        margin-bottom: 15px;
        padding-left: 25px;
        position: relative;
        line-height: 1.6;
    }
    
    .game-instructions li:before {
        content: 'ðŸŽ®';
        position: absolute;
        left: 0;
    }
    
    .play-button-large {
        display: inline-block;
        background: var(--accent);
        color: var(--dark);
        padding: 12px 35px;
        border-radius: 8px;
        font-size: 1.1rem;
        font-weight: 600;
        text-decoration: none;
        border: none;
        cursor: pointer;
        transition: all 0.3s;
        margin-top: 10px;
        min-width: 180px;
    }
    
    .play-button-large:hover {
        background: #00e68a;
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(0, 255, 136, 0.3);
    }
    
    /* Toast Notification */
    .toast {
        position: fixed;
        bottom: 30px;
        right: 30px;
        background: var(--accent);
        color: var(--dark);
        padding: 15px 25px;
        border-radius: 8px;
        font-weight: 600;
        z-index: 9999;
        transform: translateY(100px);
        opacity: 0;
        transition: transform 0.3s, opacity 0.3s;
    }
    
    .toast.show {
        transform: translateY(0);
        opacity: 1;
    }
    
    .toast.success {
        background: var(--accent);
        color: var(--dark);
    }
    
    .toast.warning {
        background: #ff9800;
        color: white;
    }
    
    .toast.info {
        background: #3498db;
        color: white;
    }
    
    @media (max-width: 768px) {
        .game-placeholder {
            padding: 20px 15px;
            gap: 15px;
        }
        
        .game-placeholder i {
            font-size: 60px;
        }
        
        .game-placeholder h3 {
            font-size: 1.5rem;
        }
        
        .game-placeholder p {
            font-size: 0.9rem;
            padding: 0 10px;
        }
        
        .game-stats {
            grid-template-columns: 1fr;
            gap: 15px;
            padding: 15px;
            max-width: 280px;
        }
        
        .stat-number {
            font-size: 1.8rem;
        }
        
        .play-button-large {
            padding: 10px 25px;
            font-size: 1rem;
            min-width: 160px;
        }
    }
</style>
{% endblock %}

{% block content %}
    <!-- Page Header -->
    <section class="page-header">
        <div class="container">
            <h1>Don't Get Bored</h1>
            <p>Play a game, don't get bored all by yourself... we got you ðŸ˜‚</p>
        </div>
    </section>

    <!-- Games Section -->
    <section class="blog">
        <div class="container">
            <div class="section-title">
                <h2>Our Games Collection</h2>
                <p>Take a break and enjoy some fun games</p>
            </div>
            
            <div class="games-grid">
                <div class="game-card" data-game-id="meteor-dodge">
                    <div class="game-image" style="background: linear-gradient(45deg, #ff6b6b, #4ecdc4);">
                        <i class="fas fa-meteor"></i>
                    </div>
                    <div class="game-content">
                        <div class="game-meta">
                            <span><i class="fas fa-gamepad"></i> Arcade</span>
                            <span><i class="fas fa-users"></i> 5000+ playing</span>
                        </div>
                        <h3>Meteor Dodge Game</h3>
                        <p>Meteor Dodge is a fast-paced arcade game where you dodge meteors, collect power-ups, and chase high scores.</p>
                        <a href="#" class="play-button">Play Now</a>
                    </div>
                </div>
                
                <div class="game-card" data-game-id="ai-puzzle">
                    <div class="game-image" style="background: linear-gradient(45deg, #3498db, #2ecc71);">
                        <i class="fas fa-puzzle-piece"></i>
                    </div>
                    <div class="game-content">
                        <div class="game-meta">
                            <span><i class="fas fa-gamepad"></i> Puzzle</span>
                            <span><i class="fas fa-users"></i> 2500+ playing</span>
                        </div>
                        <h3>AI Puzzle Challenge</h3>
                        <p>Test your problem-solving skills with our AI-generated puzzles that adapt to your skill level.</p>
                        <a href="#" class="play-button">Play Now</a>
                    </div>
                </div>
                
                <div class="game-card" data-game-id="neural-wars">
                    <div class="game-image" style="background: linear-gradient(45deg, #9b59b6, #e74c3c);">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="game-content">
                        <div class="game-meta">
                            <span><i class="fas fa-gamepad"></i> Strategy</span>
                            <span><i class="fas fa-users"></i> 3200+ playing</span>
                        </div>
                        <h3>Neural Network Wars</h3>
                        <p>Build and train your own neural network to compete against other AI in this strategy game.</p>
                        <a href="#" class="play-button">Play Now</a>
                    </div>
                </div>
                
                <div class="game-card" data-game-id="ai-quiz">
                    <div class="game-image" style="background: linear-gradient(45deg, #f39c12, #d35400);">
                        <i class="fas fa-brain"></i>
                    </div>
                    <div class="game-content">
                        <div class="game-meta">
                            <span><i class="fas fa-gamepad"></i> Quiz</span>
                            <span><i class="fas fa-users"></i> 1800+ playing</span>
                        </div>
                        <h3>AI Knowledge Quiz</h3>
                        <p>Test your knowledge about artificial intelligence, machine learning, and data science.</p>
                        <a href="#" class="play-button">Play Now</a>
                    </div>
                </div>
                
                <div class="game-card" data-game-id="code-hunter">
                    <div class="game-image" style="background: linear-gradient(45deg, #1abc9c, #27ae60);">
                        <i class="fas fa-code"></i>
                    </div>
                    <div class="game-content">
                        <div class="game-meta">
                            <span><i class="fas fa-gamepad"></i> Educational</span>
                            <span><i class="fas fa-users"></i> 4100+ playing</span>
                        </div>
                        <h3>Code Hunter</h3>
                        <p>Learn programming concepts while playing this fun game that teaches coding fundamentals.</p>
                        <a href="#" class="play-button">Play Now</a>
                    </div>
                </div>
                
                <div class="game-card" data-game-id="ai-chess">
                    <div class="game-image" style="background: linear-gradient(45deg, #e74c3c, #c0392b);">
                        <i class="fas fa-chess"></i>
                    </div>
                    <div class="game-content">
                        <div class="game-meta">
                            <span><i class="fas fa-gamepad"></i> Board Game</span>
                            <span><i class="fas fa-users"></i> 2900+ playing</span>
                        </div>
                        <h3>AI Chess Master</h3>
                        <p>Challenge our AI chess engine at different difficulty levels and improve your chess skills.</p>
                        <a href="#" class="play-button">Play Now</a>
                    </div>
                </div>
            </div>
            
            <!-- Coming Soon Section -->
            <div class="section-title" style="margin-top: 80px;">
                <h2>Coming Soon</h2>
                <p>Exciting new games we're working on</p>
            </div>
            
            <div class="games-grid">
                <div class="game-card coming-soon" data-game-id="vr-world">
                    <div class="game-image" style="background: linear-gradient(45deg, #34495e, #2c3e50);">
                        <i class="fas fa-hourglass-half"></i>
                    </div>
                    <div class="game-content">
                        <div class="game-meta">
                            <span><i class="far fa-clock"></i> Coming Soon</span>
                            <span><i class="fas fa-gamepad"></i> VR</span>
                        </div>
                        <h3>Virtual AI World</h3>
                        <p>Immerse yourself in a virtual reality world powered by artificial intelligence.</p>
                        <span class="coming-soon-badge">Coming Soon</span>
                    </div>
                </div>
                
                <div class="game-card coming-soon" data-game-id="genetic-evolution">
                    <div class="game-image" style="background: linear-gradient(45deg, #8e44ad, #3498db);">
                        <i class="fas fa-dna"></i>
                    </div>
                    <div class="game-content">
                        <div class="game-meta">
                            <span><i class="far fa-clock"></i> Coming Soon</span>
                            <span><i class="fas fa-gamepad"></i> Simulation</span>
                        </div>
                        <h3>Genetic Algorithm Evolution</h3>
                        <p>Create and evolve digital creatures using genetic algorithms in this simulation game.</p>
                        <span class="coming-soon-badge">Coming Soon</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Game Modal -->
    <div class="game-modal" id="gameModal">
        <div class="game-modal-content">
            <div class="game-modal-header">
                <button class="game-modal-close" id="closeGameModal">&times;</button>
                <h1 class="game-modal-title" id="gameTitle">Meteor Dodge Game</h1>
                <div class="game-modal-meta">
                    <span><i class="fas fa-gamepad"></i> <span id="gameCategory">Arcade</span></span>
                    <span><i class="fas fa-users"></i> <span id="gamePlayers">5000+ playing</span></span>
                    <span><i class="far fa-clock"></i> <span id="gameTime">Quick Play</span></span>
                </div>
            </div>
            
            <div class="game-modal-body">
                <div class="game-container">
                    <div class="game-placeholder" id="gamePlaceholder">
                        <i class="fas fa-meteor" id="gameIcon"></i>
                        <h3 id="gamePlaceholderTitle">Meteor Dodge</h3>
                        <p id="gamePlaceholderDescription">Get ready to dodge meteors and collect power-ups in this fast-paced arcade game!</p>
                        
                        <div class="game-stats">
                            <div class="stat-item">
                                <div class="stat-number" id="highScore">0</div>
                                <div class="stat-label">High Score</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="gamesPlayed">0</div>
                                <div class="stat-label">Games Played</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="totalTime">0</div>
                                <div class="stat-label">Minutes Played</div>
                            </div>
                        </div>
                        
                        <button class="play-button-large" id="startGameButton">Start Game</button>
                    </div>
                    
                    <iframe class="game-frame" id="gameFrame" style="display: none;"></iframe>
                </div>
                
                <div class="game-instructions">
                    <h3>How to Play</h3>
                    <ul id="gameInstructions">
                        <li>Use arrow keys or WASD to move your spaceship</li>
                        <li>Avoid hitting the falling meteors</li>
                        <li>Collect power-ups for special abilities</li>
                        <li>Survive as long as possible to score points</li>
                        <li>Compete with players worldwide on the leaderboard</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>
{% endblock %}

{% block extra_js %}
<script>
    // Games JavaScript
    document.addEventListener('DOMContentLoaded', function() {
        const gameModal = document.getElementById('gameModal');
        const closeGameModal = document.getElementById('closeGameModal');
        const gameCards = document.querySelectorAll('.game-card:not(.coming-soon)');
        const playButtons = document.querySelectorAll('.play-button');
        const startGameButton = document.getElementById('startGameButton');
        const gameFrame = document.getElementById('gameFrame');
        const gamePlaceholder = document.getElementById('gamePlaceholder');
        const toast = document.getElementById('toast');
        
        // Game data
        const games = {
            'meteor-dodge': {
                title: 'Meteor Dodge Game',
                category: 'Arcade',
                players: '5000+ playing',
                time: 'Quick Play',
                icon: 'fas fa-meteor',
                description: 'Get ready to dodge meteors and collect power-ups in this fast-paced arcade game!',
                instructions: [
                    'Use arrow keys or WASD to move your spaceship',
                    'Avoid hitting the falling meteors',
                    'Collect power-ups for special abilities',
                    'Survive as long as possible to score points',
                    'Compete with players worldwide on the leaderboard'
                ],
                gameUrl: '{% static "games/meteor-dodge/index.html" %}',
                highScore: localStorage.getItem('meteor-dodge-highscore') || 0,
                gamesPlayed: localStorage.getItem('meteor-dodge-games') || 0,
                totalTime: localStorage.getItem('meteor-dodge-time') || 0
            },
            'ai-puzzle': {
                title: 'AI Puzzle Challenge',
                category: 'Puzzle',
                players: '2500+ playing',
                time: '5-10 minutes',
                icon: 'fas fa-puzzle-piece',
                description: 'Test your problem-solving skills with our AI-generated puzzles that adapt to your skill level.',
                instructions: [
                    'Solve puzzles by moving pieces to the correct positions',
                    'Complete levels to unlock more challenging puzzles',
                    'Use hints when you get stuck',
                    'The AI adapts difficulty based on your performance',
                    'Challenge friends to beat your best times'
                ],
                gameUrl: '#',
                highScore: localStorage.getItem('ai-puzzle-highscore') || 0,
                gamesPlayed: localStorage.getItem('ai-puzzle-games') || 0,
                totalTime: localStorage.getItem('ai-puzzle-time') || 0
            },
            'neural-wars': {
                title: 'Neural Network Wars',
                category: 'Strategy',
                players: '3200+ playing',
                time: '15-30 minutes',
                icon: 'fas fa-robot',
                description: 'Build and train your own neural network to compete against other AI in this strategy game.',
                instructions: [
                    'Design your neural network architecture',
                    'Train your AI on different datasets',
                    'Compete against other neural networks',
                    'Improve your AI based on battle results',
                    'Climb the global rankings'
                ],
                gameUrl: '#',
                highScore: localStorage.getItem('neural-wars-highscore') || 0,
                gamesPlayed: localStorage.getItem('neural-wars-games') || 0,
                totalTime: localStorage.getItem('neural-wars-time') || 0
            },
            'ai-quiz': {
                title: 'AI Knowledge Quiz',
                category: 'Quiz',
                players: '1800+ playing',
                time: 'Quick Play',
                icon: 'fas fa-brain',
                description: 'Test your knowledge about artificial intelligence, machine learning, and data science.',
                instructions: [
                    'Answer multiple-choice questions about AI',
                    'Choose difficulty levels (Beginner, Intermediate, Advanced)',
                    'Earn points for correct answers',
                    'Compete in timed challenges',
                    'Track your progress and learn new concepts'
                ],
                gameUrl: '#',
                highScore: localStorage.getItem('ai-quiz-highscore') || 0,
                gamesPlayed: localStorage.getItem('ai-quiz-games') || 0,
                totalTime: localStorage.getItem('ai-quiz-time') || 0
            },
            'code-hunter': {
                title: 'Code Hunter',
                category: 'Educational',
                players: '4100+ playing',
                time: '10-20 minutes',
                icon: 'fas fa-code',
                description: 'Learn programming concepts while playing this fun game that teaches coding fundamentals.',
                instructions: [
                    'Complete coding challenges in different languages',
                    'Solve programming puzzles to progress',
                    'Learn new concepts through interactive lessons',
                    'Track your learning progress',
                    'Earn badges for completing challenges'
                ],
                gameUrl: '#',
                highScore: localStorage.getItem('code-hunter-highscore') || 0,
                gamesPlayed: localStorage.getItem('code-hunter-games') || 0,
                totalTime: localStorage.getItem('code-hunter-time') || 0
            },
            'ai-chess': {
                title: 'AI Chess Master',
                category: 'Board Game',
                players: '2900+ playing',
                time: '5-30 minutes',
                icon: 'fas fa-chess',
                description: 'Challenge our AI chess engine at different difficulty levels and improve your chess skills.',
                instructions: [
                    'Play chess against our AI engine',
                    'Choose difficulty level (Beginner to Grandmaster)',
                    'Use hints and analysis tools',
                    'Learn from your mistakes with move analysis',
                    'Track your ELO rating improvement'
                ],
                gameUrl: '#',
                highScore: localStorage.getItem('ai-chess-highscore') || 0,
                gamesPlayed: localStorage.getItem('ai-chess-games') || 0,
                totalTime: localStorage.getItem('ai-chess-time') || 0
            }
        };
        
        let currentGameId = null;
        let currentGameData = null;
        
        // Function to show toast notification
        function showToast(message, type = 'success') {
            toast.textContent = message;
            toast.className = `toast ${type} show`;
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // Function to open game modal
        function openGameModal(gameId) {
            currentGameId = gameId;
            currentGameData = games[gameId];
            
            if (currentGameData) {
                // Update modal content
                document.getElementById('gameTitle').textContent = currentGameData.title;
                document.getElementById('gameCategory').textContent = currentGameData.category;
                document.getElementById('gamePlayers').textContent = currentGameData.players;
                document.getElementById('gameTime').textContent = currentGameData.time;
                document.getElementById('gameIcon').className = currentGameData.icon;
                document.getElementById('gamePlaceholderTitle').textContent = currentGameData.title;
                document.getElementById('gamePlaceholderDescription').textContent = currentGameData.description;
                document.getElementById('highScore').textContent = currentGameData.highScore;
                document.getElementById('gamesPlayed').textContent = currentGameData.gamesPlayed;
                document.getElementById('totalTime').textContent = currentGameData.totalTime;
                
                // Update instructions
                const instructionsList = document.getElementById('gameInstructions');
                instructionsList.innerHTML = '';
                currentGameData.instructions.forEach(instruction => {
                    const li = document.createElement('li');
                    li.textContent = instruction;
                    instructionsList.appendChild(li);
                });
                
                // Show modal
                gameModal.classList.add('active');
                document.body.style.overflow = 'hidden';
                
                // Show placeholder, hide iframe
                gamePlaceholder.style.display = 'flex';
                gameFrame.style.display = 'none';
                
                // Update start button text based on game status
                if (currentGameData.gameUrl === '#') {
                    startGameButton.textContent = 'Coming Soon';
                    startGameButton.disabled = true;
                    startGameButton.style.opacity = '0.7';
                    startGameButton.style.cursor = 'not-allowed';
                } else {
                    startGameButton.textContent = 'Start Game';
                    startGameButton.disabled = false;
                    startGameButton.style.opacity = '1';
                    startGameButton.style.cursor = 'pointer';
                }
            } else {
                showToast('Game information not available', 'warning');
            }
        }
        
        // Function to start the game
        function startGame() {
            if (!currentGameData || currentGameData.gameUrl === '#') {
                showToast('This game is coming soon!', 'info');
                return;
            }
            
            // Hide placeholder, show iframe
            gamePlaceholder.style.display = 'none';
            gameFrame.style.display = 'block';
            
            // Load game in iframe
            gameFrame.src = currentGameData.gameUrl;
            
            // Update games played count
            const gamesPlayed = parseInt(currentGameData.gamesPlayed) + 1;
            localStorage.setItem(`${currentGameId}-games`, gamesPlayed);
            
            showToast(`Starting ${currentGameData.title}...`, 'success');
        }
        
        // Function to close modal
        function closeModal() {
            gameModal.classList.remove('active');
            document.body.style.overflow = 'auto';
            
            // Stop game if running
            if (gameFrame.src && gameFrame.src !== 'about:blank') {
                gameFrame.src = 'about:blank';
            }
        }
        
        // Add click event to game cards
        gameCards.forEach(card => {
            card.addEventListener('click', function(e) {
                // Don't trigger if clicking the play button
                if (!e.target.classList.contains('play-button')) {
                    const gameId = this.getAttribute('data-game-id');
                    openGameModal(gameId);
                }
            });
        });
        
        // Add click event to play buttons
        playButtons.forEach(button => {
            button.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                
                const gameCard = this.closest('.game-card');
                const gameId = gameCard.getAttribute('data-game-id');
                openGameModal(gameId);
                
                // Add click animation
                this.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    this.style.transform = 'scale(1)';
                }, 150);
            });
        });
        
        // Start game button
        startGameButton.addEventListener('click', startGame);
        
        // Close modal when clicking close button
        closeGameModal.addEventListener('click', closeModal);
        
        // Close modal when clicking outside content
        gameModal.addEventListener('click', function(e) {
            if (e.target === gameModal) {
                closeModal();
            }
        });
        
        // Close modal with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && gameModal.classList.contains('active')) {
                closeModal();
            }
        });
        
        // Handle iframe game events
        window.addEventListener('message', function(e) {
            // Handle messages from game iframes
            if (e.data && e.data.type === 'gameScore') {
                const newScore = e.data.score;
                const currentHighScore = parseInt(currentGameData.highScore);
                
                if (newScore > currentHighScore) {
                    localStorage.setItem(`${currentGameId}-highscore`, newScore);
                    document.getElementById('highScore').textContent = newScore;
                    
                    showToast(`New High Score: ${newScore}!`, 'success');
                }
                
                // Update play time if provided
                if (e.data.playTime) {
                    const currentTime = parseInt(currentGameData.totalTime);
                    const newTime = currentTime + e.data.playTime;
                    localStorage.setItem(`${currentGameId}-time`, newTime);
                    document.getElementById('totalTime').textContent = newTime;
                }
            }
        }, false);
        
        // Add hover animations to game cards
        gameCards.forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-10px) scale(1.02)';
                this.style.transition = 'transform 0.3s ease, box-shadow 0.3s ease';
                this.style.boxShadow = '0 20px 40px rgba(0, 255, 136, 0.2)';
            });
            
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0) scale(1)';
                this.style.boxShadow = 'none';
            });
        });
        
        // Coming soon cards hover effect
        const comingSoonCards = document.querySelectorAll('.game-card.coming-soon');
        comingSoonCards.forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-5px)';
                this.style.transition = 'transform 0.3s ease';
            });
            
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
            });
        });
        
        // Add click animation to coming soon cards
        comingSoonCards.forEach(card => {
            card.addEventListener('click', function() {
                const gameId = this.getAttribute('data-game-id');
                showToast(`"${gameId.replace('-', ' ')}" is coming soon! ðŸŽ®`, 'info');
            });
        });
    });
</script>
{% endblock %}