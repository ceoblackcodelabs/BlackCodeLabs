{% extends 'Home/base.html' %}
{% load static %}

{% block content %}
    <!-- Hero Section -->
    <section class="hero" id="home">
        <div id="space-container"></div>
        <div class="container hero-content">
            <h1>Engineering Your Digital Future</h1>
            <p>BlackCodeLabs delivers comprehensive technology solutions that transform businesses through custom development, intelligent automation, and data-driven innovation.</p>
            <button class="cta-button pulse">Explore Our Solutions</button>
        </div>
    </section>

    <!-- About Section -->
    <section class="about" id="about">
        <div class="section-title">
            <h2>Our Story</h2>
            <p>Engineering innovative technology solutions since 2018</p>
        </div>
        <div class="container">
            <div class="about-content">
                <div class="about-text">
                    <h2>Building Tomorrow's Technology</h2>
                    <p>Founded in 2018, BlackCodeLabs has been pioneering practical technology solutions that solve real business challenges. Our team of engineers and developers bridges the gap between innovation and implementation.</p>
                    <p>We specialize in creating robust, scalable systems—from web applications and automation tools to data platforms and security solutions—that empower businesses to operate smarter and more efficiently.</p>
                    <a href="{% url 'about' %}" class="cta-button">Learn More About Us</a>
                </div>
                <div class="about-image">
                    <img src="https://images.unsplash.com/photo-1558494949-ef010cbdcc31?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80" alt="Technology Development">
                </div>
            </div>
        </div>
    </section>

    <!-- Services Section -->
    <section class="features" id="services">
        <div class="container">
            <div class="section-title">
                <h2>Our Technology Services</h2>
                <p>End-to-end digital solutions that drive business transformation</p>
            </div>
            <div class="features-grid">
                {% for service in tech_services %}
                <div class="feature-card">
                    <div class="feature-icon">
                        {{ service.icon|safe }}
                    </div>
                    <h3>{{ service.name }}</h3>
                    <p>{{ service.description }}</p>
                </div>
                {% endfor %}
            </div>
        </div>
    </section>

    <!-- Statistics Section -->
    <section class="statistics" id="statistics">
        <div class="container">
            <div class="section-title">
                <h2>By The Numbers</h2>
                <p>Our impact across the technology landscape</p>
            </div>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number" 
                         id="stat1" 
                         data-value="{{ data_counter.projects_delivered|default:1247 }}">0</div>
                    <div class="stat-label">Projects Delivered</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" 
                         id="stat2" 
                         data-value="{{ data_counter.systems_automated|default:892 }}">0</div>
                    <div class="stat-label">Systems Automated</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" 
                         id="stat3" 
                         data-value="{{ data_counter.happy_clients|default:765 }}">0</div>
                    <div class="stat-label">Happy Clients</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" 
                         id="stat4" 
                         data-value="{{ data_counter.returning_clients|default:423 }}">0</div>
                    <div class="stat-label">Returning Clients</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Team Section -->
    <section class="team" id="team">
        <div class="container">
            <div class="section-title">
                <h2>Our Technical Leadership</h2>
                <p>Expert engineers and solution architects driving technological excellence</p>
            </div>
            <div class="team-grid">
                {% for member in team_members %}
                    <div class="team-member">
                        {% if member.picture %}
                            <div class="team-member-image">
                                <img src="{{ member.picture.url }}" alt="{{ member.name }}">
                            </div>
                        {% else %}
                            <div class="team-member-image">
                                <i class="fas fa-user"></i>
                            </div>
                        {% endif %}
                        <h3>{{ member.name }}</h3>
                        <p>{{ member.position }}</p>
                        {% if member.linkedin_url %}
                            <a href="{{ member.linkedin_url }}" target="_blank" class="team-linkedin">
                                <i class="fab fa-linkedin"></i>
                            </a>
                        {% endif %}
                    </div>
                {% endfor %}
            </div>
        </div>
    </section>

    <!-- Testimonials Section -->
    <section class="testimonials" id="testimonials">
        <div class="container testimonials-container">
            <div class="section-title">
                <h2>Client Success Stories</h2>
                <p>Hear from businesses transformed by our technology solutions</p>
            </div>
            <div class="testimonial-slider">
                {% for review in client_reviews %}
                <div class="testimonial">
                    <div class="testimonial-content">
                        <p>{{ review.review_text }}</p>
                        <div class="testimonial-rating">
                            {% for i in "12345"|make_list %}
                                {% if forloop.counter <= review.rating %}
                                    <i class="fas fa-star"></i>
                                {% else %}
                                    <i class="far fa-star"></i>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                    <div class="testimonial-author">
                        {% if review.client_picture %}
                            <div class="author-avatar">
                                <img src="{{ review.client_picture.url }}" alt="{{ review.client_name }}">
                            </div>
                        {% else %}
                            <div class="author-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                        {% endif %}
                        <div class="author-info">
                            <h4>{{ review.client_name }}</h4>
                            <p>{{ review.client_position }}</p>
                            {% if review.client_company %}
                                <small>{{ review.client_company }}</small>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </section>

    <!-- Demo Section -->
    <section class="demos" id="demos">
        <div class="container">
            <div class="section-title">
                <h2>Solution Showcase</h2>
                <p>Explore our technology capabilities</p>
            </div>
            <div class="demo-grid">
                <div class="demo-card">
                    <div class="demo-image">
                        <i class="fas fa-cogs"></i>
                    </div>
                    <div class="demo-content">
                        <h3>Automation Demo</h3>
                        <p>See how our workflow automation systems can streamline your business processes.</p>
                    </div>
                </div>
                <div class="demo-card">
                    <div class="demo-image">
                        <i class="fas fa-database"></i>
                    </div>
                    <div class="demo-content">
                        <h3>Data Dashboard</h3>
                        <p>Experience real-time data visualization and predictive analytics in action.</p>
                    </div>
                </div>
                <div class="demo-card">
                    <div class="demo-image">
                        <i class="fas fa-mobile-alt"></i>
                    </div>
                    <div class="demo-content">
                        <h3>App Prototype</h3>
                        <p>Explore interactive prototypes of custom applications we've developed.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Newsletter Section -->
    <section class="newsletter" id="newsletter">
        <div class="container">
            <div class="newsletter-content">
                <h2>Stay Updated</h2>
                <p>Subscribe for the latest in technology solutions, automation trends, and development insights.</p>
                <form class="newsletter-form">
                    <input type="email" class="newsletter-input" placeholder="Enter your email" required>
                    <button type="submit" class="newsletter-button">Subscribe</button>
                </form>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta" id="contact">
        <div class="container cta-content">
            <h2>Ready to Transform Your Technology Infrastructure?</h2>
            <p>Join forward-thinking businesses leveraging BlackCodeLabs's comprehensive solutions for growth and efficiency.</p>
            <a href="{% url 'demo' %}" class="cta-button">Start Your Project</a>
        </div>
    </section>
{% endblock %}

{% block extra_js %}
<script>
// Updated JavaScript for dynamic statistics from database
document.addEventListener('DOMContentLoaded', function() {
    // Update the statistics initialization function
    function initStatistics() {
        const stat1 = document.getElementById('stat1');
        const stat2 = document.getElementById('stat2');
        const stat3 = document.getElementById('stat3');
        const stat4 = document.getElementById('stat4');

        // Get values from data attributes (this is the correct way)
        const projectsDelivered = parseInt(stat1.getAttribute('data-value')) || 1247;
        const systemsAutomated = parseInt(stat2.getAttribute('data-value')) || 892;
        const happyClients = parseInt(stat3.getAttribute('data-value')) || 765;
        const returningClients = parseInt(stat4.getAttribute('data-value')) || 423;
        
        const targetValues = [projectsDelivered, systemsAutomated, happyClients, returningClients];
        const duration = 2000; // ms
        const interval = 20; // ms
        
        const counters = [stat1, stat2, stat3, stat4];
        
        counters.forEach((counter, index) => {
            if (!counter) return;
            
            let current = 0;
            const increment = targetValues[index] / (duration / interval);
            
            const timer = setInterval(() => {
                current += increment;
                if (current >= targetValues[index]) {
                    clearInterval(timer);
                    current = targetValues[index];
                    
                    // Format numbers
                    if (targetValues[index] >= 1000) {
                        counter.textContent = (current / 1000).toFixed(1) + 'k+';
                    } else {
                        counter.textContent = Math.round(current);
                    }
                } else {
                    if (targetValues[index] >= 1000) {
                        counter.textContent = Math.round(current / 1000) + 'k+';
                    } else {
                        counter.textContent = Math.round(current);
                    }
                }
            }, interval);
        });
    }
    
    // Override the initStatistics function in the base template
    if (window.initStatistics) {
        // Save the original function
        const originalInitStatistics = window.initStatistics;
        
        // Create a new function that calls both
        window.initStatistics = function() {
            // Call the original if it exists
            if (typeof originalInitStatistics === 'function') {
                originalInitStatistics();
            }
            
            // Call our new statistics function
            initStatistics();
        };
    } else {
        // If no initStatistics exists, create it
        window.initStatistics = initStatistics;
    }
    
    // Auto-play testimonials
    function initTestimonialSlider() {
        const testimonialSlider = document.querySelector('.testimonial-slider');
        if (!testimonialSlider) return;
        
        const testimonials = testimonialSlider.querySelectorAll('.testimonial');
        if (testimonials.length <= 1) return;
        
        let currentIndex = 0;
        
        function showNextTestimonial() {
            testimonials[currentIndex].classList.remove('active');
            currentIndex = (currentIndex + 1) % testimonials.length;
            testimonials[currentIndex].classList.add('active');
            
            // Update dots if they exist
            const dots = testimonialSlider.querySelectorAll('.testimonial-dot');
            if (dots.length > 0) {
                dots.forEach(dot => dot.classList.remove('active'));
                dots[currentIndex].classList.add('active');
            }
        }
        
        // Initialize first testimonial
        testimonials[0].classList.add('active');
        
        // Create navigation dots
        const dotsContainer = document.createElement('div');
        dotsContainer.className = 'testimonial-dots';
        testimonialSlider.appendChild(dotsContainer);
        
        testimonials.forEach((_, index) => {
            const dot = document.createElement('div');
            dot.className = 'testimonial-dot';
            if (index === 0) dot.classList.add('active');
            dot.addEventListener('click', () => {
                testimonials[currentIndex].classList.remove('active');
                dotsContainer.querySelectorAll('.testimonial-dot').forEach(d => d.classList.remove('active'));
                currentIndex = index;
                testimonials[currentIndex].classList.add('active');
                dot.classList.add('active');
            });
            dotsContainer.appendChild(dot);
        });
        
        // Auto rotate every 5 seconds
        setInterval(showNextTestimonial, 5000);
    }
    
    // Initialize on page load
    setTimeout(() => {
        // Call initStatistics (it will be called via the window.initStatistics override)
        if (window.initStatistics && typeof window.initStatistics === 'function') {
            window.initStatistics();
        }
        
        initTestimonialSlider();
    }, 1000);
});
</script>

<style>
/* Additional CSS for enhanced testimonials and team */
.testimonial-rating {
    color: #FFD700;
    margin-top: 10px;
    font-size: 18px;
}

.testimonial-author .author-avatar img {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid #4CAF50;
}

.team-member-image img {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    object-fit: cover;
}
.author-avatar img {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    object-fit: cover;
}

/* Ensure statistics are visible during count */
.stat-number {
    font-size: 3rem;
    font-weight: bold;
    color: #4CAF50;
    transition: all 0.3s ease;
}
</style>
{% endblock %}